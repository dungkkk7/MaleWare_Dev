#include <windows.h>
#include <iostream>
#include <string>

int main(int argc, char* argv[]) {
    // Kiểm tra số lượng tham số dòng lệnh
    if (argc < 2) {
        std::cerr << "Usage: " << argv[0] << " <dll path>" << std::endl;
        return EXIT_FAILURE;
    }

    // Lấy đường dẫn DLL từ tham số dòng lệnh
    std::string filePath = argv[1];
    std::wcout << L"Loading " << std::wstring(filePath.begin(), filePath.end()) << L"....." << std::endl;

    // Nạp DLL
    HMODULE hDll = LoadLibraryA(filePath.c_str());
    if (hDll == NULL) {
        // Lấy mã lỗi chi tiết
        DWORD errorCode = GetLastError();
        std::cerr << "Failed to load DLL. Error code: " << errorCode << std::endl;
        return EXIT_FAILURE;
    }

    // Giải phóng DLL khi không sử dụng
    FreeLibrary(hDll);

    return EXIT_SUCCESS;
}